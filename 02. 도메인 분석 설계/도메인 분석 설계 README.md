# ë„ë©”ì¸ ë¶„ì„ ì„¤ê³„

## ìš”êµ¬ì‚¬í•­ ë¶„ì„

![Untitled](https://github.com/soohyunnn/jpa-1/assets/58289675/9701d73c-6bdd-499f-be72-d0524139cdf2)

**ì‹¤ì œ ë™ì‘í•˜ëŠ” í™”ë©´ì„ ë¨¼ì € í™•ì¸í•œë‹¤.**

**ê¸°ëŠ¥ ëª©ë¡**

- íšŒì› ê¸°ëŠ¥
    - íšŒì› ë“±ë¡
    - íšŒì› ì¡°íšŒ
- ìƒí’ˆ ê¸°ëŠ¥
    - ìƒí’ˆ ë“±ë¡
    - ìƒí’ˆ ìˆ˜ì •
    - ìƒí’ˆ ì¡°íšŒ
- ì£¼ë¬¸ ê¸°ëŠ¥
    - ìƒí’ˆ ì£¼ë¬¸
    - ì£¼ë¬¸ ë‚´ì—­ ì¡°íšŒ
    - ì£¼ë¬¸ ì·¨ì†Œ
- ê¸°íƒ€ ìš”êµ¬ì‚¬í•­
    - ìƒí’ˆì€ ì¬ê³  ê´€ë¦¬ê°€ í•„ìš”í•˜ë‹¤.
    - ìƒí’ˆì˜ ì¢…ë¥˜ëŠ” ë„ì„œ, ìŒë°˜, ì˜í™”ê°€ ìˆë‹¤.
    - ìƒí’ˆì„ ì¹´í…Œê³ ë¦¬ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.
    - ìƒí’ˆ ì£¼ë¬¸ì‹œ ë°°ì†¡ ì •ë³´ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆë‹¤.

## ë„ë©”ì¸ ëª¨ë¸ê³¼ í…Œì´ë¸” ì„¤ê³„

![Untitled 1](https://github.com/soohyunnn/jpa-1/assets/58289675/8dac9bbd-061f-46b6-b581-4c27793b42fa)

**íšŒì›, ì£¼ë¬¸, ìƒí’ˆì˜ ê´€ê³„** : íšŒì›ì€ ì—¬ëŸ¬ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³  í•œ ë²ˆ ì£¼ë¬¸í•  ë•Œ ì—¬ëŸ¬ ìƒí’ˆì„ ì„ íƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì£¼ë¬¸ê³¼ ìƒí’ˆì€ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë‹¤. í•˜ì§€ë§Œ ì´ëŸ° ë‹¤ëŒ€ë‹¤ ê´€ê³„ëŠ” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ë¬¼ë¡ ì´ê³  ì—”í‹°í‹°ì—ì„œë„ ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ê·¸ë¦¼ì²˜ëŸ¼ ì£¼ë¬¸ìƒí’ˆì´ë¼ëŠ” ì—”í‹°í‹°ë¥¼ ì¶”ê°€í•´ì„œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ë¡œ í’€ì–´ëƒˆë‹¤.

**ìƒí’ˆ ë¶„ë¥˜** : ìƒí’ˆì€ ë„ì„œ, ìŒë°˜, ì˜í™”ë¡œ êµ¬ë¶„ë˜ëŠ”ë° ìƒí’ˆì´ë¼ëŠ” ê³µí†µ ì†ì„±ì„ ì‚¬ìš©í•˜ë¯€ë¡œ ìƒì† êµ¬ì¡°ë¡œ í‘œí˜„í–ˆë‹¤.

âš ï¸Â ì˜ˆì œë¥¼ ìœ„í•´ JPAì—ì„œ ë‹¤ë£°ìˆ˜ ìˆëŠ” ê´€ê³„ë¥¼ ëª¨ë‘ ë‹¤ë£¨ë„ë¡ ì„¤ê³„í–ˆë‹¤. (ì‹¤ë¬´ì—ì„œëŠ” N:Në¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤)

### íšŒì› ì—”í‹°í‹° ë¶„ì„

![Untitled 2](https://github.com/soohyunnn/jpa-1/assets/58289675/e40dc5f7-5d9b-4fd7-b4bb-e8ec20371cdc)

- **íšŒì›(Member):** ì´ë¦„ê³¼ ì„ë² ë””ë“œ íƒ€ì…ì¸ ì£¼ì†Œ(`Address`), ê·¸ë¦¬ê³  ì£¼ë¬¸(`orders`) ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì§„ë‹¤.
- **ì£¼ë¬¸(Order):** í•œ ë²ˆ ì£¼ë¬¸ì‹œ ì—¬ëŸ¬ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì£¼ë¬¸ê³¼ ì£¼ë¬¸ìƒí’ˆ(`OrderItem`)ì€ ì¼ëŒ€ë‹¤ ê´€ê³„ë‹¤. ì£¼ë¬¸ì€ ìƒí’ˆì„ ì£¼ë¬¸í•œ íšŒì›ê³¼ ë°°ì†¡ ì •ë³´, ì£¼ë¬¸ ë‚ ì§œ, ì£¼ë¬¸ ìƒíƒœ(`status`)ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ì£¼ë¬¸ ìƒíƒœëŠ” ì—´ê±°í˜•ì„ ì‚¬ìš©í–ˆëŠ”ë° ì£¼ë¬¸(`ORDER`), ì·¨ì†Œ(`CANCEL`)ì„ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.
- **ì£¼ë¬¸ìƒí’ˆ(OrderItem):** ì£¼ë¬¸í•œ ìƒí’ˆ ì •ë³´ì™€ ì£¼ë¬¸ ê¸ˆì•¡(`orderPrice`), ì£¼ë¬¸ ìˆ˜ëŸ‰(`count`) ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤. (ë³´í†µ `OrderLine`, `LineItem`ìœ¼ë¡œ ë§ì´ í‘œí˜„í•œë‹¤.)
- **ìƒí’ˆ(Item):** ì´ë¦„, ê°€ê²©, ì¬ê³ ìˆ˜ëŸ‰(`stockQuantity`)ì„ ê°€ì§€ê³  ìˆë‹¤. ìƒí’ˆì„ ì£¼ë¬¸í•˜ë©´ ì¬ê³ ìˆ˜ëŸ‰ì´ ì¤„ì–´ë“ ë‹¤. ìƒí’ˆì˜ ì¢…ë¥˜ë¡œëŠ” ë„ì„œ, ìŒë°˜, ì˜í™”ê°€ ìˆëŠ”ë° ê°ê°ì€ ì‚¬ìš©í•˜ëŠ” ì†ì„±ì´ ì¡°ê¸ˆì”© ë‹¤ë¥´ë‹¤.
- **ë°°ì†¡(Delivery):** ì£¼ë¬¸ì‹œ í•˜ë‚˜ì˜ ë°°ì†¡ ì •ë³´ë¥¼ ìƒì„±í•œë‹¤. ì£¼ë¬¸ê³¼ ë°°ì†¡ì€ ì¼ëŒ€ì¼ ê´€ê³„ë‹¤.
- **ì¹´í…Œê³ ë¦¬(Category):** ìƒí’ˆê³¼ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤. `parent`, `child`ë¡œ ë¶€ëª¨, ìì‹ ì¹´í…Œê³ ë¦¬ë¥¼ ì—°ê²°í•œë‹¤.
- **ì£¼ì†Œ(Address):** ê°’ íƒ€ì…(ì„ë² ë””ë“œ íƒ€ì…)ì´ë‹¤. íšŒì›ê³¼ ë°°ì†¡(Delivery)ì—ì„œ ì‚¬ìš©í•œë‹¤.

> ì°¸ê³ : íšŒì› ì—”í‹°í‹° ë¶„ì„ ê·¸ë¦¼ì—ì„œ Orderì™€ Deliveryê°€ ë‹¨ë°©í–¥ ê´€ê³„ë¡œ ì˜ëª» ê·¸ë ¤ì ¸ ìˆëŠ”ë° ì–‘ë°©í–¥ ê´€ê³„ê°€ ë§ë‹¤.
> 

> ì°¸ê³ : íšŒì›ì´ ì£¼ë¬¸ì„ í•˜ê¸° ë•Œë¬¸ì—, íšŒì›ì´ ì£¼ë¬¸ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì§€ëŠ” ê²ƒì€ ì–¼í• ë³´ë©´ ì˜ ì„¤ê³„í•œ ê²ƒ ê°™ì§€ë§Œ, ê°ì²´ ì„¸ìƒì€ ì‹¤ì œ ì„¸ê³„ì™€ëŠ” ë‹¤ë¥´ë‹¤. ì‹¤ë¬´ì—ì„œëŠ” íšŒì›ì´ ì£¼ë¬¸ì„ ì°¸ì¡°í•˜ì§€ ì•Šê³ , ì£¼ë¬¸ì´ íšŒì›ì„ ì°¸ì¡°í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶©ë¶„í•˜ë‹¤. ì—¬ê¸°ì„œëŠ” ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ì˜ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ì„œ ì¶”ê°€í–ˆë‹¤.
> 

### íšŒì› í…Œì´ë¸” ë¶„ì„

![Untitled 3](https://github.com/soohyunnn/jpa-1/assets/58289675/1e4907b3-b91b-4f9a-8c3e-f1609eb81fc7)

**MEMBER:** íšŒì› ì—”í‹°í‹°ì˜ `Address` ì„ë² ë””ë“œ íƒ€ì… ì •ë³´ê°€ íšŒì› í…Œì´ë¸”ì— ê·¸ëŒ€ë¡œ ë“¤ì–´ê°”ë‹¤. ì´ê²ƒì€ `DELIVERY` í…Œì´ë¸”ë„ ë§ˆì°¬ê°€ì§€ë‹¤.

**ITEM:** ì•¨ë²”, ë„ì„œ, ì˜í™” íƒ€ì…ì„ í†µí•©í•´ì„œ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ ë§Œë“¤ì—ˆë‹¤. `DTYPE` ì»¬ëŸ¼ìœ¼ë¡œ íƒ€ì…ì„ êµ¬ë¶„í•œë‹¤.

ITEMì€ ì‹±ê¸€í…Œì´ë¸” ì „ëµì„ ì‚¬ìš©!

> ì‹±ê¸€í…Œì´ë¸” ì „ëµ ğŸ‘‰Â í•œí…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ëª¨ë‘ ë„£ì–´ë†“ê³  êµ¬ë¶„ê°’ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ì „ëµ
> 

> ì°¸ê³ : í…Œì´ë¸”ëª…ì´ `ORDER`ê°€ ì•„ë‹ˆë¼ `ORDERS`ì¸ ê²ƒì€ ë°ì´í„°ë² ì´ìŠ¤ê°€ `order by` ë•Œë¬¸ì— ì˜ˆì•½ì–´ë¡œ ì¡ê³  ìˆëŠ” ê²½ìš°ê°€ ë§ë‹¤. ê·¸ë˜ì„œ ê´€ë¡€ìƒ `ORDERS`ë¥¼ ë§ì´ ì‚¬ìš©í•œë‹¤.
> 

> **ì°¸ê³ : ì‹¤ì œ ì½”ë“œì—ì„œëŠ” DBì— ì†Œë¬¸ì + _(ì–¸ë”ìŠ¤ì½”ì–´) ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•˜ê² ë‹¤.**
ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ëª…, ì»¬ëŸ¼ëª…ì— ëŒ€í•œ ê´€ë¡€ëŠ” íšŒì‚¬ë§ˆë‹¤ ë‹¤ë¥´ë‹¤. ë³´í†µì€ ëŒ€ë¬¸ì + _(ì–¸ë”ìŠ¤ì½”ì–´)ë‚˜ ì†Œë¬¸ì + _(ì–¸ë”ìŠ¤ì½”ì–´) ë°©ì‹ ì¤‘ì— í•˜ë‚˜ë¥¼ ì§€ì •í•´ì„œ ì¼ê´€ì„± ìˆê²Œ ì‚¬ìš©í•œë‹¤. ê°•ì˜ì—ì„œ ì„¤ëª…í•  ë•ŒëŠ” ê°ì²´ì™€ ì°¨ì´ë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”, ì»¬ëŸ¼ëª…ì€ ëŒ€ë¬¸ìë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ, **ì‹¤ì œ ì½”ë“œì—ì„œëŠ” ì†Œë¬¸ì + _(ì–¸ë”ìŠ¤ì½”ì–´) ìŠ¤íƒ€ì¼ì„ ì‚¬ìš©í•˜ê² ë‹¤.**
> 

### ì—°ê´€ê´€ê³„ ë§¤í•‘ ë¶„ì„

- **íšŒì›ê³¼ ì£¼ë¬¸:** ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ì˜ ì–‘ë°©í–¥ ê´€ê³„ë‹¤. ë”°ë¼ì„œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì„ ì •í•´ì•¼ í•˜ëŠ”ë°, ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ì£¼ë¬¸ì„ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ `Order.member`ë¥¼ `ORDERS.MEMBER_ID` ì™¸ë˜ í‚¤ì™€ ë§¤í•‘í•œë‹¤.
- **ì£¼ë¬¸ìƒí’ˆê³¼ ì£¼ë¬¸:** ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ê´€ê³„ë‹¤. ì™¸ë˜ í‚¤ê°€ ì£¼ë¬¸ìƒí’ˆì— ìˆìœ¼ë¯€ë¡œ ì£¼ë¬¸ìƒí’ˆì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ `OrderItem.order`ë¥¼ `ORDER_ITEM.ORDER_ID` ì™¸ë˜ í‚¤ì™€ ë§¤í•‘í•œë‹¤.
- **ì£¼ë¬¸ìƒí’ˆê³¼ ìƒí’ˆ:** ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ ê´€ê³„ë‹¤. `OrderItem.item`ì„ `ORDER_ITEM.ITEM_ID` ì™¸ë˜ í‚¤ì™€ ë§¤í•‘í•œë‹¤.
- **ì£¼ë¬¸ê³¼ ë°°ì†¡:** ì¼ëŒ€ì¼ ì–‘ë°©í–¥ ê´€ê³„ë‹¤. `Order.delivery`ë¥¼ `ORDERS.DELIVERY_ID` ì™¸ë˜ í‚¤ì™€ ë§¤í•‘í•œë‹¤.
- **ì¹´í…Œê³ ë¦¬ì™€ ìƒí’ˆ:** `@ManyToMany`ë¥¼ ì‚¬ìš©í•´ì„œ ë§¤í•‘í•œë‹¤. (ì‹¤ë¬´ì—ì„œ @ManyToManyëŠ” ì‚¬ìš©í•˜ì§€ ë§ì. ì—¬ê¸°ì„œëŠ” ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì˜ˆì œë¡œ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ì¶”ê°€í–‡ì„ ë¿ì´ë‹¤)

> ì£¼ë¬¸ì´ í•„ìš”í•  ë•Œ Memberê°€ í•„ìš”í•˜ë‹¤. Member ì—ì„œ Orderë¡œì˜ 1:NëŠ” í•„ìš”ì—†ë‹¤. (ì—¬ê¸°ì„œëŠ” ì˜ˆì œë‹ˆê¹Œ ì–‘ë°©í–¥ìœ¼ë¡œ ì„¤ê³„í•˜ì˜€ìœ¼ë‹ˆ ì°¸ê³ â£ï¸)
> 

> â£ï¸FKëŠ” ë§ì´ Accessí•˜ëŠ” DBì— ë‘ëŠ”ê²Œ ì¢‹ë‹¤.
> 
> 
> â†’ ê·¸ë˜ì„œ DELIVERYë‘ ORDERSê°€ 1:1 ë§¤í•‘ì¸ë° ORDERSì— FKë¥¼ ë‘ì—ˆë‹¤.
> 

> **ì°¸ê³ : ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ê³³ì„ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•´ë¼**
ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ ë‹¨ìˆœíˆ ì™¸ë˜ í‚¤ë¥¼ ëˆ„ê°€ ê´€ë¦¬í•˜ëƒì˜ ë¬¸ì œì´ì§€ ë¹„ì¦ˆë‹ˆìŠ¤ìƒ ìš°ìœ„ì— ìˆë‹¤ê³  ì£¼ì¸ìœ¼ë¡œ ì •í•˜ë©´ ì•ˆëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ ìë™ì°¨ì™€ ë°”í€´ê°€ ìˆìœ¼ë©´, ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„œ í•­ìƒ ë‹¤ìª½ì— ì™¸ë˜ í‚¤ê°€ ìˆìœ¼ë¯€ë¡œ ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ë°”í€´ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ë©´ ëœë‹¤. ë¬¼ë¡  ìë™ì°¨ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥ í•œê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ìë™ì°¨ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ë©´ ìë™ì°¨ê°€ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ” ë°”í€´ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ ê°’ì´ ì—…ë°ì´íŠ¸ ë˜ë¯€ë¡œ ê´€ë¦¬ì™€ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë µê³ , ì¶”ê°€ì ìœ¼ë¡œ ë³„ë„ì˜ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ê°€ ë°œìƒí•˜ëŠ” ì„±ëŠ¥ ë¬¸ì œë„ ìˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ JPA ê¸°ë³¸í¸ì„ ì°¸ê³ í•˜ì.
> 

## ì—”í‹°í‹° í´ë˜ìŠ¤ ê°œë°œ

- ì˜ˆì œì—ì„œëŠ” ì„¤ëª…ì„ ì‰½ê²Œí•˜ê¸° ìœ„í•´ ì—”í‹°í‹° í´ë˜ìŠ¤ì— Getter, Setterë¥¼ ëª¨ë‘ ì—´ê³ , ìµœëŒ€í•œ ë‹¨ìˆœí•˜ê²Œ ì„¤ê³„
- ì‹¤ë¬´ì—ì„œëŠ” ê°€ê¸‰ì  GetterëŠ” ì—´ì–´ë‘ê³ , SetterëŠ” ê¼­ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œ

> ì°¸ê³ : ì´ë¡ ì ìœ¼ë¡œ Gettter, Setter ëª¨ë‘ ì œê³µí•˜ì§€ ì•Šê³ , ê¼­ í•„ìš”í•œ ë³„ë„ì˜ ë©”ì„œë“œë¥¼ ì œê³µí•˜ëŠ”ê²Œ ê°€ì¥ ì´ìƒì ì´ë‹¤. í•˜ì§€ë§Œ ì‹¤ë¬´ì—ì„œ ì—”í‹°í‹°ì˜ ë°ì´í„°ëŠ” ì¡°íšŒí•  ì¼ì´ ë„ˆë¬´ ë§ìœ¼ë¯€ë¡œ, Getterì˜ ê²½ìš° ëª¨ë‘ ì—´ì–´ë‘ëŠ” ê²ƒì´ í¸ë¦¬í•˜ë‹¤. GetterëŠ” ì•„ë¬´ë¦¬ í˜¸ì¶œí•´ë„ í˜¸ì¶œ í•˜ëŠ” ê²ƒ ë§Œìœ¼ë¡œ ì–´ë–¤ ì¼ì´ ë°œìƒí•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. 
í•˜ì§€ë§Œ SetterëŠ” ë¬¸ì œê°€ ë‹¤ë¥´ë‹¤. Setterë¥¼ í˜¸ì¶œí•˜ë©´ ë°ì´í„°ê°€ ë³€í•œë‹¤. Setterë¥¼ ë§‰ ì—´ì–´ë‘ë©´ ê°€ê¹Œìš´ ë¯¸ë˜ì— ì—”í‹°í‹°ê°€ ë„ëŒ€ì²´ ì™œ ë³€ê²½ë˜ëŠ”ì§€ ì¶”ì í•˜ê¸° ì ì  í˜ë“¤ì–´ì§„ë‹¤. ê·¸ë˜ì„œ ì—”í‹°í‹°ë¥¼ ë³€ê²½í•  ë•ŒëŠ” Setter ëŒ€ì‹ ì— ë³€ê²½ ì§€ì ì´ ëª…í™•í•˜ë„ë¡ ë³€ê²½ì„ ìœ„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë©”ì„œë“œë¥¼ ë³„ë„ë¡œ ì œê³µí•´ì•¼ í•œë‹¤.
> 

**íšŒì› ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;

import java.util.ArrayList;
import java.util.List;

@Entity
@Getter
@Setter
public class Member {

    @Id
    @GeneratedValue
    @Column(name = "member_id")
    private Long id;

    private String name;

    @Embedded
    private Address address;

    @OneToMany(mappedBy = "member")
    private List<Order> orders = new ArrayList<>();  // ê°€ì ¸ë‹¤ ì“°ê¸°ë§Œ í•˜ì! ìˆ˜ì •í•˜ì§€ ë§ê³ !

}
```

> ì°¸ê³ : ì—”í‹°í‹°ì˜ ì‹ë³„ìëŠ” `id`ë¥¼ ì‚¬ìš©í•˜ê³  PK ì»¬ëŸ¼ëª…ì€ `member_id`ë¥¼ ì‚¬ìš©í–ˆë‹¤. ì—”í‹°í‹°ëŠ” íƒ€ì…(ì—¬ê¸°ì„œëŠ” `Member`)ì´ ìˆìœ¼ë¯€ë¡œ `id` í•„ë“œë§Œìœ¼ë¡œ ì‰½ê²Œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. í…Œì´ë¸”ì€ íƒ€ì…ì´ ì—†ìœ¼ë¯€ë¡œ êµ¬ë¶„ì´ ì–´ë µë‹¤.
ê·¸ë¦¬ê³  í…Œì´ë¸”ì€ ê´€ë¡€ìƒ `í…Œì´ë¸”ëª… + id`ë¥¼ ë§ì´ ì‚¬ìš©í•œë‹¤. ì°¸ê³ ë¡œ ê°ì²´ì—ì„œ `id` ëŒ€ì‹ ì— `memberId`ë¥¼ ì‚¬ìš©í•´ë„ ëœë‹¤. ì¤‘ìš”í•œ ê²ƒì€ ì¼ê´€ì„±ì´ë‹¤.
> 

**ì£¼ë¬¸ ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;

import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;

import static jakarta.persistence.FetchType.LAZY;

@Entity
@Table(name= "orders")
@Getter
@Setter
public class Order {

    @Id @GeneratedValue
    @Column(name = "order_id")
    private Long id;

    @ManyToOne(fetch = LAZY)
    @JoinColumn(name = "member_id")
    private Member member;

    @OneToMany(mappedBy = "order", cascade = CascadeType.ALL)
    private List<OrderItem> orderItems = new ArrayList<>();

    @OneToOne(fetch = LAZY, cascade = CascadeType.ALL)
    @JoinColumn(name = "delivery_id")
    private Delivery delivery;

    private LocalDateTime orderDate;  //ì£¼ë¬¸ì‹œê°„

    @Enumerated(EnumType.STRING)
    private OrderStatus status;  //ì£¼ë¬¸ìƒíƒœ [ORDER, CANCEL]

    //==ì—°ê´€ê´€ê³„ ë©”ì„œë“œ==//
    public void setMember(Member member) {
        this.member = member;
    }

    public void addOrderItem(OrderItem orderItem) {
        orderItems.add(orderItem);
        orderItem.setOrder(this);
    }

    public void setDelivery(Delivery delivery) {
        this.delivery = delivery;
        delivery.setOrder(this);
    }

}
```

**ì£¼ë¬¸ ìƒíƒœ**

```java
package jpabook.jpashop.domain;

public enum OrderStatus {
    ORDER, CANCEL
}
```

**ì£¼ë¬¸ìƒí’ˆ ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import jpabook.jpashop.domain.item.Item;
import lombok.Getter;
import lombok.Setter;

import static jakarta.persistence.FetchType.LAZY;

@Entity
@Getter
@Setter
public class OrderItem {

    @Id
    @GeneratedValue
    @Column(name = "order_item_id")
    private Long id;

    @ManyToOne(fetch = LAZY)
    @JoinColumn(name ="item_id")
    private Item item;

    @ManyToOne(fetch = LAZY)
    @JoinColumn(name = "order_id")
    private Order order;

    private int orderPrice;  //ì£¼ë¬¸ ê°€ê²©
    private int count;  //ì£¼ë¬¸ ìˆ˜ëŸ‰

}
```

**ìƒí’ˆ ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain.item;

import jakarta.persistence.*;
import jpabook.jpashop.domain.Category;
import lombok.Getter;
import lombok.Setter;

import java.util.ArrayList;
import java.util.List;

@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "dtype")
@Getter
@Setter
public abstract class Item {

    @Id
    @GeneratedValue
    @Column(name = "item_id")
    private Long id;

    private String name;
    private int price;
    private int stockQuantity;

    @ManyToMany(mappedBy = "items")
    private List<Category> categories = new ArrayList<>();

}
```

**ìƒí’ˆ - ë„ì„œ ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain.item;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;
import lombok.Getter;
import lombok.Setter;

@Entity
@DiscriminatorValue("B")
@Getter
@Setter
public class Book extends Item{

    private String author;
    private String isbn;

}
```

**ìƒí’ˆ - ìŒë°˜ ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain.item;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;
import lombok.Getter;
import lombok.Setter;

@Entity
@DiscriminatorValue("A")
@Getter
@Setter
public class Album extends Item{

    private String artist;
    private String etc;

}
```

**ìƒí’ˆ - ì˜í™” ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain.item;

import jakarta.persistence.DiscriminatorValue;
import jakarta.persistence.Entity;
import lombok.Getter;
import lombok.Setter;

@Entity
@DiscriminatorValue("M")
@Getter
@Setter
public class Movie extends Item{

    private String director;
    private String actor;

}
```

**ë°°ì†¡ ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import lombok.Getter;
import lombok.Setter;

import static jakarta.persistence.FetchType.LAZY;

@Entity
@Getter
@Setter
public class Delivery {

    @Id
    @GeneratedValue
    @Column(name = "delivery_id")
    private Long id;

    @OneToOne(fetch = LAZY, mappedBy = "delivery")
    private Order order;

    @Embedded
    private Address address;

    @Enumerated(EnumType.STRING)
    private DeliveryStatus status;  // READY, COMP

}
```

**ë°°ì†¡ ìƒíƒœ**

```java
package jpabook.jpashop.domain;

public enum DeliveryStatus {
    READY, COMP
}
```

**ì¹´í…Œê³ ë¦¬ ì—”í‹°í‹°**

```java
package jpabook.jpashop.domain;

import jakarta.persistence.*;
import jpabook.jpashop.domain.item.Item;
import lombok.Getter;
import lombok.Setter;

import java.util.ArrayList;
import java.util.List;

import static jakarta.persistence.FetchType.LAZY;

@Entity
@Getter
@Setter
public class Category {

    @Id
    @GeneratedValue
    @Column(name = "category_id")
    private Long id;

    private String name;

    @ManyToMany
    @JoinTable(name = "category_item",
            joinColumns = @JoinColumn(name = "category_id"),
            inverseJoinColumns = @JoinColumn(name = "item_id"))
    private List<Item> items = new ArrayList<>();

    @ManyToOne(fetch = LAZY)
    @JoinColumn(name = "parent_id")
    private Category parent;

    @OneToMany(mappedBy = "parent")
    private List<Category> child = new ArrayList<>();

    //==ì—°ê´€ê´€ê³„ ë©”ì„œë“œ==//
    public void addChildCategory(Category child) {
        this.child.add(child);
        child.setParent(this);
    }

}
```

> ì°¸ê³ : ì‹¤ë¬´ì—ì„œëŠ” `@ManyToMany`ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ì.
`@ManyToMany`ëŠ” í¸ë¦¬í•œ ê²ƒ ê°™ì§€ë§Œ, ì¤‘ê°„ í…Œì´ë¸”(`CATEGORY_ITEM`)ì— ì»¬ëŸ¼ì„ ì¶”ê°€í•  ìˆ˜ ì—†ê³ , ì„¸ë°€í•˜ê²Œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê¸° ì–´ë µê¸° ë•Œë¬¸ì— ì‹¤ë¬´ì—ì„œ ì‚¬ìš©í•˜ê¸°ì—ëŠ” í•œê³„ê°€ ìˆë‹¤. ì¤‘ê°„ ì—”í‹°í‹°(`CategoryItem`ë¥¼ ë§Œë“¤ê³  `@ManyToOne`, `@OneToMany`ë¡œ ë§¤í•‘í•´ì„œ ì‚¬ìš©í•˜ì. ì •ë¦¬í•˜ë©´ ë‹¤ëŒ€ë‹¤ ë§¤í•‘ì„ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ë§¤í•‘ìœ¼ë¡œ í’€ì–´ë‚´ì„œ ì‚¬ìš©í•˜ì.
> 

**ì£¼ì†Œ ê°’ íƒ€ì…**

```java
package jpabook.jpashop.domain;

import jakarta.persistence.Embeddable;
import lombok.Getter;

@Embeddable
@Getter
public class Address {

    private String city;
    private String street;
    private String zipcode;

    protected Address() {

    }

    public Address(String city, String street, String zipcode) {
        this.city = city;
        this.street = street;
        this.zipcode = zipcode;
    }
}
```

> ì°¸ê³ : ê°’ íƒ€ì…ì€ ë³€ê²½ ë¶ˆê°€ëŠ¥í•˜ê²Œ ì„¤ê³„í•´ì•¼ í•œë‹¤.
`@Setter`ë¥¼ ì œê±°í•˜ê³ , ìƒì„±ìì—ì„œ ê°’ì„ ëª¨ë‘ ì´ˆê¸°í™”í•´ì„œ ë³€ê²½ ë¶ˆê°€ëŠ¥í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì. JPA ìŠ¤í™ìƒ ì—”í‹°í‹°ë‚˜ ì„ë² ë””ë“œ íƒ€ì…(`@Embeddable`)ì€ ìë°” ê¸°ë³¸ ìƒì„±ì(default constructor)ë¥¼ `public` ë˜ëŠ” `protected`ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤. `public`ìœ¼ë¡œ ë‘ëŠ” ê²ƒ ë³´ë‹¤ëŠ” `protected`ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ê·¸ë‚˜ë§ˆ ë” ì•ˆì „í•˜ë‹¤.
JPAê°€ ì´ëŸ° ì œì•½ì„ ë‘ëŠ” ì´ìœ ëŠ” JPA êµ¬í˜„ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ë¦¬í”Œë™ì…˜ ê°™ì€ ê¸°ìˆ ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
> 

> mappedByëŠ” ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì— ì‘ì„±í•´ì•¼ í•œë‹¤. ì´ê±¸ ì‘ì„±í•œë‹¤ê³  í•´ì„œ FK ê°’ì´ ë³€ê²½ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤.
> 

## ì—”í‹°í‹° ì„¤ê³„ì‹œ ì£¼ì˜ì 

**ì—”í‹°í‹°ì—ëŠ” ê°€ê¸‰ì  Setterë¥¼ ì‚¬ìš©í•˜ì§€ ë§ì**

Setterê°€ ëª¨ë‘ ì—´ë ¤ìˆë‹¤. ë³€ê²½ í¬ì¸íŠ¸ê°€ ë„ˆë¬´ ë§ì•„ì„œ, ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë µë‹¤. ë‚˜ì¤‘ì— ë¦¬íŒ©í† ë§ìœ¼ë¡œ Setter ì œê±°

**ëª¨ë“  ì—°ê´€ê´€ê³„ëŠ” ì§€ì—°ë¡œë”©ìœ¼ë¡œ ì„¤ì •!**

- ì¦‰ì‹œë¡œë”©(EAGER)ì€ ì˜ˆì¸¡ì´ ì–´ë µê³ , ì–´ë–¤ SQLì´ ì‹¤í–‰ë ì§€ ì¶”ì í•˜ì§€ ì–´ë µë‹¤. íŠ¹íˆ JPQLì„ ì‹¤í–‰í•  ë•Œ N+1 ë¬¸ì œê°€ ìì£¼ ë°œìƒí•œë‹¤.
- ì‹¤ë¬´ì—ì„œ ëª¨ë“  ì—°ê´€ê´€ê³„ëŠ” ì§€ì—°ë¡œë”©(LAZY)ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.
- ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ í•¨ê»˜ DBì—ì„œ ì¡°íšŒí•´ì•¼ í•˜ë©´, fetch join ë˜ëŠ” ì—”í‹°í‹° ê·¸ë˜í”„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.
- @XToOne(OneToOne, ManyToOne) ê´€ê³„ëŠ” ê¸°ë³¸ì´ ì¦‰ì‹œë¡œë”©ì´ë¯€ë¡œ ì§ì ‘ ì§€ì—°ë¡œë”©ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.

**ì»¬ë ‰ì…˜ì€ í•„ë“œì—ì„œ ì´ˆê¸°í™” í•˜ì**

ì»¬ë ‰ì…˜ì€ í•„ë“œì—ì„œ ë°”ë¡œ ì´ˆê¸°í™” í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.

- null ë¬¸ì œì—ì„œ ì•ˆì „í•˜ë‹¤.
- í•˜ì´ë²„ë„¤ì´íŠ¸ëŠ” ì—”í‹°í‹°ë¥¼ ì˜ì†í™” í•  ë•Œ, ì»¬ë ‰ì…˜ì„ ê°ì‹¸ì„œ í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ì œê³µí•˜ëŠ” ë‚´ì¥ ì»¬ë ‰ì…˜ìœ¼ë¡œ ë³€ê²½í•œë‹¤. ë§Œì•½ getOrders()ì²˜ëŸ¼ ì„ì˜ì˜ ë©”ì„œë“œì—ì„œ ì»¬ë ‰ì…˜ì„ ì˜ëª» ìƒì„±í•˜ë©´ í•˜ì´ë²„ë„¤ì´íŠ¸ ë‚´ë¶€ ë©”ì»¤ë‹ˆì¦˜ì— ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ í•„ë“œë ˆë²¨ì—ì„œ ìƒì„±í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì•ˆì „í•˜ê³ , ì½”ë“œë„ ê°„ê²°í•˜ë‹¤.

```java
Member member = new Member();
System.out.println(member.getOrders().getClass());
em.persist(member);
System.out.println(member.getOrders().getClass());

//ì¶œë ¥ ê²°ê³¼
class java.util.ArrayList
class org.hibernate.collection.internal.PersistentBag
```

**í…Œì´ë¸”, ì»¬ëŸ¼ëª… ìƒì„± ì „ëµ**

ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„œ í•˜ì´ë²„ë„¤ì´íŠ¸ ê¸°ë³¸ ë§¤í•‘ ì „ëµì„ ë³€ê²½í•´ì„œ ì‹¤ì œ í…Œì´ë¸” í•„ë“œëª…ì€ ë‹¤ë¦„

- [https://docs.spring.io/spring-boot/docs/2.1.3.RELEASE/reference/htmlsingle/#howto- configure-hibernate-naming-strategy](https://docs.spring.io/spring-boot/docs/2.1.3.RELEASE/reference/htmlsingle/#howto-%20configure-hibernate-naming-strategy)
- [https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#naming](https://docs.jboss.org/hibernate/orm/5.4/userguide/html_single/Hibernate_User_Guide.html#naming)

í•˜ì´ë²„ë„¤ì´íŠ¸ ê¸°ì¡´ êµ¬í˜„: ì—”í‹°í‹°ì˜ í•„ë“œëª…ì„ ê·¸ëŒ€ë¡œ í…Œë¦¬ë¸”ì˜ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ì‚¬ìš©(`SpringPhysicalNamingStrategy`)

ìŠ¤í”„ë§ ë¶€íŠ¸ ì‹ ê·œ ì„¤ì • (ì—”í‹°í‹°(í•„ë“œ) â†’ í…Œì´ë¸”(ì»¬ëŸ¼))

1. ì¹´ë©œ ì¼€ì´ìŠ¤ â†’ ì–¸ë”ìŠ¤ì½”ì–´(memberPoint â†’ member_point)
2. .(ì ) â†’ _(ì–¸ë”ìŠ¤ì½”ì–´)
3. ëŒ€ë¬¸ì â†’ ì†Œë¬¸ì

**ì ìš© 2ë‹¨ê³„**

1. ë…¼ë¦¬ëª… ìƒì„±: ëª…ì‹œì ìœ¼ë¡œ ì»¬ëŸ¼, í…Œì´ë¸”ëª…ì„ ì§ì ‘ ì ì§€ ì•Šìœ¼ë©´ ImplicitNamingStrategy ì‚¬ìš©
    
    `spring.jpa.hibernate.naming.implicit-strategy`: í…Œì´ë¸”ì´ë‚˜, ì»¬ëŸ¼ëª…ì„ ëª…ì‹œí•˜ì§€ ì•Šì„ ë•Œ ë…¼ë¦¬ëª… ì ìš©,
    
2. ë¬¼ë¦¬ëª… ì ìš©: 
    
    `spring.jpa.hibernate.naming.physical-strategy`: ëª¨ë“  ë…¼ë¦¬ëª…ì— ì ìš©ë¨, ì‹¤ì œ í…Œì´ë¸”ì— ì ìš©(username â†’ usernm ë“±ìœ¼ë¡œ íšŒì‚¬ ë£°ë¡œ ë°”ê¿€ ìˆ˜ ìˆìŒ)
    

**ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ë³¸ ì„¤ì •**

```java
spring.jpa.hibernate.naming.implicit-strategy:
org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
```

```java
spring.jpa.hibernate.naming.physical-strategy:
org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy
```